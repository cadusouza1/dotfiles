# Automatically rearaging windows
setw -g main-pane-width 50%
setw -g main-pane-height 50%
# set-hook -g after-split-window "select-layout main-horizontal"
# set-hook -g after-kill-pane "select-layout main-horizontal"
set-hook -g after-split-window "select-layout main-vertical"
set-hook -g after-kill-pane "select-layout main-vertical"

unbind C-b

set -g prefix M-f
set-option -g history-limit 100000

unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display "Reloaded tmux.conf"

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind x kill-pane
bind & kill-window

# Bind Alt-b to switch to the 'secondprefix' key table without requiring a prefix
bind-key -n M-b switch-client -T secondprefix

bind-key -T secondprefix m split-pane "gum-man 1"
bind-key -T secondprefix n split-pane
bind-key -T secondprefix s split-pane "tmux-client-switcher"

# Moving panes and alat
bind-key -T secondprefix b break-pane
bind-key -T secondprefix 1 join-pane -t :1 \; select-layout
bind-key -T secondprefix 2 join-pane -t :2 \; select-layout
bind-key -T secondprefix 3 join-pane -t :3 \; select-layout
bind-key -T secondprefix 4 join-pane -t :4 \; select-layout
bind-key -T secondprefix 5 join-pane -t :5 \; select-layout
bind-key -T secondprefix 6 join-pane -t :6 \; select-layout
bind-key -T secondprefix 7 join-pane -t :7 \; select-layout
bind-key -T secondprefix 8 join-pane -t :8 \; select-layout
bind-key -T secondprefix 9 join-pane -t :9 \; select-layout

# Another key table that will be used to edit stuff
bind-key -T secondprefix e switch-client -T secondprefix-edit

# Common files thay I edit
bind-key -T secondprefix-edit a split-pane "$EDITOR ~/.config/alacritty/alacritty.toml"
bind-key -T secondprefix-edit t split-pane "$EDITOR ~/.config/tmux/tmux.conf"
bind-key -T secondprefix-edit u split-pane "$EDITOR ~/.scripts/url-bookmarks/urls.txt"
bind-key -T secondprefix-edit v split-pane "vim ~/.vimrc"
bind-key -T secondprefix-edit w split-pane "$EDITOR ~/.xmonad/xmonad.hs"

# Fuzzy finder for specific paths
bind-key -T secondprefix-edit b split-pane "fzf-edit ~/.config/xmobar"
bind-key -T secondprefix-edit c split-pane "fzf-edit ~/.scripts/ ~/.xmonad/ ~/.local/bin/ ~/.config/"
bind-key -T secondprefix-edit f split-pane "fzf-edit ~/.config/fish/"
bind-key -T secondprefix-edit h split-pane "fzf-edit ~/"
bind-key -T secondprefix-edit n split-pane "fzf-edit ~/.config/nvim/"
bind-key -T secondprefix-edit o split-pane "fzf-edit ~/Documents/Kdu/"
bind-key -T secondprefix-edit p split-pane "fzf-edit ~/.local/share/nvim/site/pack/packer/start/"
bind-key -T secondprefix-edit s split-pane "fzf-edit ~/.scripts/"

# Another key table that will be used to open stuff
bind-key -T secondprefix o switch-client -T secondprefix-open

# Commands I run
bind-key -T secondprefix-open c split-pane -v "~/.scripts/cheatsheet/cheatman"
bind-key -T secondprefix-open h split-pane -v "htop"
bind-key -T secondprefix-open n split-pane -v "nmtui"

# Another key table that will be used to bind layout things
bind-key -T secondprefix l switch-client -T secondprefix-layout

## Change the layout
# bind-key -T secondprefix-layout v set-hook -g after-split-window "select-layout main-vertical" \; set-hook -g after-kill-pane "select-layout main-vertical" \; select-layout main-vertical
# bind-key -T secondprefix-layout h set-hook -g after-split-window "select-layout main-horizontal" \; set-hook -g after-kill-pane "select-layout main-horizontal" \; select-layout main-horizontal
bind-key -T secondprefix-layout v run-shell "tmux-layout-changer main-vertical"
bind-key -T secondprefix-layout h run-shell "tmux-layout-changer main-horizontal"

# Window title begins by 1 and not 0
set  -g base-index 1
setw -g pane-base-index 1

# panes
bind > swap-pane -D       # swap current pane with the next one
bind < swap-pane -U       # swap current pane with the previous one

set -g default-terminal "xterm-256color"
set -g default-shell /bin/fish
set -ga terminal-overrides ",xterm-256color:Tc"
set -sg escape-time 0
set-option -g status-position bottom

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'egel/tmux-gruvbox'
set -g @plugin 'whame/tmux-modal'
set -g @tmux-gruvbox 'dark'

set -g @modal-commands-conf ~/.config/tmux/my-commands.conf
set -g @modal-keybindings-conf ~/.config/tmux/my-keys.conf

run '~/.config/tmux/plugins/tpm/tpm'
